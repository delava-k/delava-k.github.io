<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Delava товары для рукоделия и канзаши"> 
  <link rel="stylesheet" type="text/css" href=".././css/main.css">
  <title>Delava - канзаши товары</title>

<script>


function st2(ist) {
 if (typeof(Storage) !== "undefined"){ 
 var sidz=localStorage.getItem('idz');
 if ((sidz === null) || (sidz == "")) {
  var sidz=Date.now();
  localStorage.setItem('idz',sidz);
  sidz=localStorage.getItem('idz');
 }

 var arid = new Array();
 var arco = new Array();
 var sz=localStorage.getItem('zakaz');

 if ((sz != null) && (sz != "")) { arid = sz.split(',');}

 for (var j = 0; j < arid.length; j++)
 {
  vr=localStorage.getItem(arid[j]);
  if ((vr != null) && (vr != "")) {	
   arco[j]=vr;
   arid[j]=arid[j].slice(1);
  }
 }

 var prim=screen.availWidth+' * '+screen.availHeight+' / '+screen.width+' * '+screen.height+' ('+navigator.platform+')';
 var xhr=new XMLHttpRequest();
 var st='https://delava.000webhostapp.com/st2.php?ist='+ist+'&idz='+sidz+'&disp='+encodeURIComponent(prim)+'&zakaz='+encodeURIComponent(arid.join('|'))+'&com='+encodeURIComponent(arco.join('|'));
 xhr.open('GET', st, true);
 xhr.send();

 } else {
  var sidz='100';
  var prim=screen.availWidth+' * '+screen.availHeight+' / '+screen.width+' * '+screen.height+' ('+navigator.platform+')';
  var xhr=new XMLHttpRequest();
  var st='https://delava.000webhostapp.com/st2.php?ist='+ist+'&idz='+sidz+'&disp='+encodeURIComponent(prim)+'&zakaz='+encodeURIComponent('error Storage')+'&com='+encodeURIComponent('error Storage');
  xhr.open('GET', st, true);
  xhr.send();
  alert('Sorry! No Web Storage support..')
 }

}



function cCopy() {//кнопка копирования в буфер всего заказа, если более 500 нужно вызвать отдельную большую форму, если менее, тосразу копируем
 if (typeof(Storage) !== "undefined"){ 

 var h=1;
 var tmp="";

 var arid = new Array();
 var sz=localStorage.getItem('zakaz');
 if ((sz != null) && (sz != "")) { arid = sz.split(',');} 

 for (var j = 0; j < arid.length; j++)
 {
  vr=localStorage.getItem(arid[j]);
  if ((vr != null) && (vr != "")) {	
	tmp=tmp+arid[j].slice(1)+"-"+vr+"\n";
        h=h+1;
  }
 }

  st2('copyz');

	if (tmp.length>=500-h){//если более 500 в счете, то отдельная форма для нескольких частей
	 document.location.href = "zakaz_big.htm";
	}
	else{ 
	  var copyText = document.getElementById("z");
	  copyText.select();
	  document.execCommand("Copy");
	}
 } else {alert('Sorry! No Web Storage support..')}
}







function GetSchet() {
 if (typeof(Storage) !== "undefined"){ 
 var z="";
 var arid = new Array();
 var sz=localStorage.getItem('zakaz');

 if ((sz != null) && (sz != "")) { arid = sz.split(',');} 

 document.getElementById("z").rows=arid.length+1;


 for (var j = 0; j < arid.length ; j++)
 {
  vr=localStorage.getItem(arid[j]);
  if ((vr != null) && (vr != "")) {z=z+arid[j].slice(1)+"-"+vr+"\n";}
 }
 document.getElementById('z').innerHTML = z;



 for (var i = 0; i < 100; i++) 
 {
  vr=localStorage.getItem(arid[i]);
  if ((vr != null) && (vr != "")) 
  { 
     var im=document.getElementById("i"+i);
     im.src = ".././img/120/"+arid[i].slice(1)+".jpg";

     var am=document.getElementById("a"+i);
     am.href = arid[i].slice(1)+".htm";

	document.getElementById("d"+i).style="display:auto";
	document.getElementById("dr"+i).innerHTML = localStorage.getItem(arid[i]);
	document.getElementById("r"+i).value = localStorage.getItem(arid[i]);
/*	document.getElementById("k"+i).innerHTML = "Код: "+arid[i].slice(1);*/
	document.getElementById("t"+i).innerHTML = localStorage.getItem('t'+arid[i]);

  }else{
	document.getElementById("d"+i).style="display:none";
  }
 }

/* 100/200 */                  
 if (arid.length>=100) {document.getElementById('zak_next').style="display:auto";}


 } else {alert('Sorry! No Web Storage support..')}
}



function cS(i) {
 if (typeof(Storage) !== "undefined"){ 

  var arid = new Array();
  var sz=localStorage.getItem('zakaz');
  if ((sz != null) && (sz != "")) { arid = sz.split(',');}//строку zakaz в массив arid


  var zn=document.getElementById('r'+i).value;
  if ((zn=="введите тут колво и нажмите ДОБАВИТЬ")||(zn=="")||(zn==null)){
    zn="";
    localStorage.removeItem(arid[i]);
  }else{
    localStorage.setItem(arid[i],zn); //в заказе коды постоянные, меняется только в LS значения по ним
  }

  if (zn==""){
	arid.splice(i, 1);
	localStorage.setItem('zakaz',arid.join(','));
  }

 GetSchet();
 } else {alert('Sorry! No Web Storage support..')}
}






function cD(i) {
 if (typeof(Storage) !== "undefined") 
 {

  var arid = new Array();
  var sz=localStorage.getItem('zakaz');
  if ((sz != null) && (sz != "")) { arid = sz.split(',');}//строку zakaz в массив arid


  if (localStorage.getItem(arid[i]) != "") {
      localStorage.removeItem(arid[i]);
  }

  arid.splice(i, 1);//удаляем и-тый из заказа
  localStorage.setItem('zakaz',arid.join(','));

 GetSchet();//перечитали все элементы
 } else {alert('Sorry! No Web Storage support..')}
}




</script>



</head>
<body> 

<div class="w100">

<div class="dpc w100w"><div class="header"><a class="hw" href=".././index.html">ВАШ ЗАКАЗ</a>
        <input class="nav-m_cb" type="checkbox" id="m1">
        <label class="nav-m" for="m1">Меню</label>
        <nav class="nav">
            <a class="nav__item" href="kontakti.htm">МЫ В СОЦСЕТЯХ</a>
            <a class="nav__item" href="kak_zakazat.htm">КАК ЗАКАЗАТЬ</a>
            <a class="nav__item" href=".././index.html">КАТАЛОГ ТОВАРОВ</a>
        </nav>
</div></div>




<div>
<div class="w33"><button onclick="cCopy(1)" type="button" class="bl">Копировать</button></div>
<div class="w33"><button onclick="javascript:history.back(3)" type="button" class="bc">Назад</button></div>
<div class="w33"><form action="deletezakaz.htm"><button type="submit" class="br">Удалить все</button></form></div>
</div>

<hr><div>
<p style="font-size: 12px;color: #FF0000;">Нажмите выше кнопку [<b>Копировать</b>].</p>
<p style="font-size: 12px;color: #000;">Перейдите в переписку инстаграм, нажмите <b>Вставить</b>.<br> Подробнее тут - <a href="kak_zakazat.htm">КАК ЗАКАЗАТЬ</a>.</p>
</div>


<textarea id="z"  rows=3 style="font-size: 1em;color: #FF0000;width:98%;padding:0px"></textarea> 
<hr><p>Товары из вашего заказа:</p><hr>
<!--DB-->





<!--Для следующей страницы, имена полей 1-100 всегда, href и i в LS.zakaz на +100 -->
<a id="zak_next" class="w100" style="display:none" href="zakaz2.htm">Следующие товары из Вашего заказа</a>
<script>
  GetSchet();
  st2('z');
</script>
        
</body></html>